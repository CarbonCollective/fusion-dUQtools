# Create

The create subcommand creates the UQ run files.

To run the command:

`duqtools create config.yaml`

Where `config.yaml` could be something like:

```yaml
# config.yaml
workspace: ./workspace
create:
  template: template_model
  data:
    db: jet
    run_in_start_at: 7000
    run_out_start_at: 8000
  matrix:
    - ids: zeff
      operator: add
      values: [1, 2, 3]
    - ids: t_i_average
      operator: multiply
      values: [1.1, 1.2, 1.3]
```

`workspace` specifies the working directory. All input files for the jetto runs will be created in subdirectories of this path.

The create subroutine takes as a template directory. This can be a directory with a finished run, or one just stored by JAMS (but not yet started). `duqtools` uses the input IDS machine (`db`) name, `user`, `shot`, `run` number from `jetto.in` to find the data to modify for the UQ runs.

Next, we specify the output. The `data` key specifies the machine name where to store the data (`db`). `duqtools` will write the input data files for UQ start with the run number given by `run_in_start_at`. The data generated by the UQ runs (from jetto) will be stored starting by the run number given by `run_out_start_at`.

`matrix` specifies the operations to apply. This can be any of the basic [numpy arithmetic operations](https://numpy.org/doc/stable/reference/routines.math.html#arithmetic-operations), i.e. 'add', 'multiply', 'divide', 'power', 'subtract', 'floor_divide', 'mod', and 'remainder'. `ids` is the name of the profile to modify.

(For the moment, this works on `imas.DBEntry.get('core_profiles').profiles1d[0].{ids}`)

Each of the values given will result in a new data file. For example:

```yaml
    - ids: zeff
      operator: add
      values: [1, 2, 3]
```

will generate 3 entries, `zeff += 1`, `zeff += 2`, and `zeff += 3`.

When combined with:

```yaml
    - ids: t_i_average
      operator: multiply
      values: [1.1, 1.2, 1.3]
```

it will generate another 3 entries, `t_i_average *= 1.1`, `t_i_average *= 1.2`, and `t_i_average *= 1.3`. Because `matrix` takes the [Cartesian product](https://en.wikipedia.org/wiki/Cartesian_product) of all operations, 9 (3 for `zeff` and 3 for `t_i_average`) data files will be written in total for all possible combinations.
